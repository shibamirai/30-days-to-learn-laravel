# [30. The Everything Episode](https://laracasts.com/series/30-days-to-learn-laravel-11/episodes/30)

[このレッスンのソースコードを見る](https://github.com/laracasts/pixel-position/commit/ce6156528d618921d9ff67fed9b0723b4dc6c231)

## すべてはエピソード

00:07
Okay.
> よし。

00:09
All right. Is this thing running recording? We are good?
> 大丈夫だ。録画されてるかな？問題ない？

00:14
I don't know how much time we have.
> あとどれだけ時間が残っているか分からない。

00:15
Well, I need to close those curtains too.
> ああ、カーテンも閉めないと。

00:17
They could be here any minute,
> 彼らはもうすぐここにやってくるだろう。

00:19
But I didn't want to leave you hanging. We can't have a 30 days course with only 29 days.
> でも君たちを見捨てることはできない。たった29日で30日間のコースはできないんだ。

00:23
So here's the deal. If anybody knocks on your door, we never met. You don't know Laracast.
> だからこうしよう。誰かが君の家のドアをノックしても、私たちは会ったことがない、あなたはLaracastを知らない。

00:29
Okay, we may have to go quick, but let's get started.
> いいね。すぐ行かないといけないかもしれないけど、始めよう。

00:33
Now, I do have one compromise we need to make in order to fit all of this in to a single video, and I'll show you.
> ここで、このすべてを１本の動画に収めるために１つだけ妥協しなければならないことがあります。これです。

00:40
Now, here is my Laravel Herd root directory, and yeah, you can see pixel positions, but I also have a backup version where I've been working behind the scenes to save us just a little bit of time.
> ここが私のLaravel Herdのルートディレクトリです。それからここにPixel Positionがありますね。さらにバックアップ用のバージョンがあります。時間の節約のために裏でやっておきたいことをする場所です。

00:50
So we're going to go into resources, views, components. And just this once I'm going to ask forgiveness for copying a bunch of form related components so that I don't have to manually type them out.
> その中のresouces/views/componentsディレクトリを開きます。そして今回に限りこうすることを許してください。ここからフォームに関する多数のコンポーネントをコピーします。一から入力する手間を省くためです。

01:03
Trust me, we'll quickly go over it, but you've seen this before, you're already familiar with it. Let's skip over this process.
> こうやって手順を省略しますが、コンポーネントの作成手順は前に見ているのでみなさんご存じですよね。このプロセスは飛ばしましょう。

01:10
So I will copy this directory, switch back to our real project, in resources, views, components, and I will paste it in.
> ということでこのディレクトリをコピーし、本来のプロジェクトに戻り、resources/views/componentsディレクトリに貼り付けます。

01:19
And yeah, we'll talk about this more in a moment.
> これについての詳細は後で話します。

01:21
Cool, so now let's start with authentication.
> いいですね。では認証から始めましょう。

01:24
I'm going to go into my routes file and let's set up our end points.
> ルートファイルを開き、エンドポイントの設定を行います。

01:28
And I'm going to do these all at once again to save a bit of time.
> 時間の節約のため、まとめて行います。

01:31
So register will hit a, how about registered user controller?
> /registerはRegisteredUserControllerにしましょうか。

01:36
Again, this is a recap of the authentication episodes, and this will hit a create action.
> 何度も言いますが、これは認証のエピソードでやったことです。そしてこれはcreateアクションにしましょう。

01:42
Next, when you post to that endpoint, that will hit a store.
> 次に、そのエンドポイントにPOSTしたときは、storeアクションを呼び出すようにします。

01:47
So we are storing a new registered user.
> 新たに登録されたユーザを保存するからです。

01:49
And of course ignore the squiggly lines just for a minute.
> 当然、警告の波線がでますが、しばらくこのままにしておきます。

01:51
Next, login.
> 次はログインです。

01:53
So if you make a get request to log in, this will hit again auth controller, login controller, session controller, whatever you want.
> /loginへのGETリクエストで呼び出すのは、AuthControllerでもLoginControllerでもSessionControllerでも何でも構いません。

02:02
And this will hit a create action because we are creating a new session. That's how I think of it.
> 新たにセッションを作成するので、createアクションにしましょう。私はそう考えます。

02:07
Next, when you post that endpoint, that will hit a store action.
> 次に、そこにPOSTしたときは、storeアクションにします。

02:10
And then finally, let's do a delete request to slash log out, and yeah, that will hit a destroy action.
> そして最後に、/logoutへのDELETEリクエストを用意します。これはdestroyアクションにします。

02:18
Alright, let's create these controllers now.
> ではこれらのコントローラを作成しましょう。

02:20
Php artisan make me a  controller called session controller, and let's set up a full resouce for it.
> php aritsanでSeesionControllerという名前のコントローラを作り、リソースアクションをすべて用意しましょう。

02:29
And then, let's another one, but this time for registered user controller.
> 続いて別のもの、今度はRegisteredUserControllerです。

02:33
Alright, so yeah, let's import these
> では、これらをインポートしましょう。

02:37
And let's start with registration.
> そして認証に取り掛かります。

02:39
All right. And later of course we will remove any actions that we don't make use of.
> もちろん後で、使用しないアクションは取り除きます。

02:43
Alright, so this is going to load, how about auth register?
> では、これはauth/registerをロードするようにしましょうか。

02:47
In this case, I'm going to use a different directory name and that's fine.
> この時点ではまだ存在していないディレクトリを使っていますが、問題ありません。

02:50
And also, again, in the spirit of saving time, I'm going to make use of my editor a bit more.
> ここでまた時間を節約するために、私が使っているエディタの機能を使いたいと思います。

02:55
So in this case, I can option click and create the view all at once.
> このケースでは、Option + クリックでビューをすぐに作ることができます。

03:00
And you'll see it automatically creates the auth directory and that file. And that's going to help us a lot.
> すると自動的にauthディレクトリとそのファイルが作られるのが分かるでしょう。とても便利です。

03:06
Alright, so let's create a layout.
> ではレイアウトを作りましょう。

03:10
And yeah, let's start with a page heading.
> ページ見出しから始めます。

03:12
We'll call it register. And yeah, how about font bold?
> 「登録」にしましょう。フォントは太字がいいですね。

03:16
Let's center the text.
> 真ん中寄せにしましょう。

03:17
I want it pretty big, so how about text for xl? And a little margin below it.
> 大きくしたいので、テキストはXLでどうでしょうか？下に少しマージンもつけましょう。

03:23
Okay, so I can imagine that this is a standard page heading, which means why don't we move it into its own component like this. page heading dot blade dot php, and paste it in.
> これは標準的なページ見出しになると思います。何が言いたいのかというと、こんな風にコンポーネント化しましょうということです。page-heading.blade.phpを作成して、これを中に貼り付けます。

03:34
All right, now this will be our slot. Cool.
> ここがスロットになるでしょう。いいですね。

03:38
So now, if I switch back, we can swap it out with page heading.
> これで、戻って、これをpage-hadingに置き換えることができます。

03:43
Okay. Now I'm going to use some of these form components.
> よし、と。ではフォームコンポーネントのいくつかを使ってみましょう。

03:46
So again, yeah, if you take a look at them, you've done these before, right? This is what a button looks like and mostly we're just extranting Tailwind classes, but we do have a couple of things that might be nice.
> 見てみると、これもやったことがありますよね？ここがボタンの見た目を決めているところで、ほとんどTailwindのクラスを取り出しただけですが、もう少しやっておいたほうがいいことがあります。

03:56
So I have one component called form, and this will create a form. It adds some default classes. And then it also handles figuring out whether to add the CSRF hidden field and the method field.
> formというコンポーネントがあり、これはフォームを作成します。いくつかデフォルトのクラスも追加します。それからCSRFの隠しフィールドやメソッドフィールドも扱います。

04:08
So notice it defaults to a method of get, but if we change that to post or put or patch, as long as it's not get, it knows that we always need to include these two things, which you learned about in the forms lesson.
> これのデフォルトはGETメソッドになっていますが、これをPOSTやPUT、PATCH、とにかくGET以外に変更したときは、常にこの２つのものを含める必要があるということが書かれています。この２つについてはフォームのレッスンでやりましたね。

04:22
But yeah, other than that, here's an input.
> それから他には、ここにinputがあります。

04:24
So I create a field and a field is just a wrapper for an input. It contains a label, it contains the input itself, and it contains an error. You've seen this a million times.
> だからここでフィールドを作成しており、フィールドは単なるinputのラッパーになっています。そこにはラベルがあり、inputタグ自身があり、エラーもあります。これは何度も見たことがあるでしょう。

04:35
And if you want, visit GitHub and you can inspect it and copy it over to your project.
> 必要であれば、GitHubにアクセスして中身を調べて、あなたのプロジェクトにコピーすることもできます。

04:40
Okay. Yeah, once again, it's going to save us so much time. Just give me this one.
> はい、これでまた時間を節約することができます。これを使わせてください。

04:45
Alright, so let's build up our forms.
> ではフォームを作っていきましょう。

04:47
And do note whenever you have a component within a directory, you need to do the directory name dot and then the component name.
> それからこれを覚えておきましょう。ディレクトリの中にあるコンポーネントを使う時は、ディレクトリ名の後に"."をつけて、それにコンポーネント名をつなげます。

04:54
Alright, so the method in this case is going to be post and the action is going to be register.
> この場合のメソッドはPOSTで、アクションはregisterになります。

05:00
Alright, so first step, I'm going to need an input.
> では、まず第一段階として、inputが必要です。

05:04
And for my inputs I accept a label and a name and it takes care of the rest.
> 私が用意したinputはラベルと名前を受け取るようになっています。その他は設定済みです。

05:08
So the label is going to be your name and then also the name for the input, which just happens to be name in this case.
> ラベルは"あなたの名前"とし、inputの名前はこの場合たまたま同じくnameとします。

05:16
Alright, let me show you what this looks like in the browser.
> これがブラウザでどのように見えるかお見せしましょう。

05:18
If I visit slash register, yeah, there we go. Looks good to me.
> /registerにアクセスすると、この通り。よさそうですね。

05:23
Alright, back to PHPStorm.
> エディタに戻ります。

05:25
Alright, next. And actually real quick, let's just stick with name. That way this one can be email.
> では次です。その前に名前のところをもうちょっと修正しましょう。そうするとこちらはEmailとすることができます。

05:30
Now in this case, the type for the input should not be text. It should be email.
> この場合、inputのtypeはtextではいけません。emailになります。

05:35
Alright, next I want two more. So we will have one for the password and then also you have to confirm your password. So password confirmation.
> 続いてinputをもう２つ追加します。１つはパスワードで、それからパスワードの確認もする必要があります。なのでもう１つは"パスワードの確認"です。

05:44
All right, password and type for the input is also password, and this is password underscore confirmation. And make sure it takes the same shape.
> 名前はpasswordで、inputのtypeもpasswordです。こっちはpassword_confirmationですね。同じ形になるようにtypeも設定しましょう。

05:53
Alright next, down at the bottom we could have a form button and this could say create account.
> では次です。この下にフォームボタンを設置して、'Create Account'とします。

06:00
And let's have a look.
> 見てみましょう。

06:02
Yeah, name, email, password and create account. But notice there is no padding at the bottom.
> 名前にメールアドレスにパスワードにアカウント登録ボタンができています。でも下に隙間がないですね。

06:06
Maybe I could add a little padding to the body here. I think that's okay. Pb-10 just push it down a little bit and that's fine.
> このbodyに少しパディングを追加すればいけると思います。pb-10で少し下に押し下げます。いいですね。

06:14
Maybe even a little more actually.
> もう少し下げましょう。

06:17
Yeah, that's good.
> これでいいでしょう。

06:18
Now think about it. When you register you also need to create an employer.
> ではこれを考えてみてください。ユーザ登録をしたら、雇用主も作成する必要があります。

06:22
So I have a divider component, and that just creates a little line as you can see right here, yeah, just a little devider.
> ということで仕切り線のコンポーネントを設置します。これは細い線を引くだけです。ご覧のように単なる仕切りの線です。

06:32
And then we're going to have a section for the employer details.
> それから雇用主の詳細セクションを用意します。

06:36
For example, let's copy this.
> 例えば、これをコピーしましょう。

06:37
I need a name for your employer. So how about employer name, and the name for this input will be employer.
> 雇用主の名前が必要です。ラベルは"Employer Name"にして、inputのnameは"employer"とします。

06:45
And then also we need one for logo. So I will call that logo.
> 続いてロゴ用にも１つ必要です。nameは"logo"にしましょう。

06:50
And this is a file input. So I'm going to set type to file in this case.
> そしてこれはファイル入力です。ですのでこの場合のtypeはfileとします。

06:54
So yeah, notice any attributes I provide here of course will be passed through here and that's how attributes works.
> ここで設定した属性はもちろんここに渡されます。このように書くと属性がセットされます。

07:01
In this case, I'm just extracting the defaults into its own array so that it's easier to consume. And that's a good approach you might want to take.
> ここでは、(merge()の代わりに)デフォルト値を配列に取り出して分かりやすくしています。いい方法なので使ってみてください。

07:09
Alright, back to arc.
> では、サイトを開いて確認しましょう。

07:10
So we have all of this and then the employer name and logo.
> これらに加えて雇用主名とロゴが追加されました。

07:14
Alright, next, as you probably know, anytime you have a form that will accept a file upload, on the form tag itself you need to set the enctype to multipart slash form dash data. And that's just how it will be encoded in this situation.
> では次です。ご存じかと思いますが、ファイルアップロードを行うフォームでは、フォームタグ自身のenctypeに"multipart/form-data"をつける必要があります。これがどのようにエンコードされるべきかを示しています。

07:30
Pretty standard HTML stuff here.
> 一般的なHTMLの話です。

07:32
Alright, so let's go to registered user controller.
> では、RegisteredUserControllerを開きましょう。

07:35
And when we submit that form, we will now hit this endpoint.
> 先ほどのフォームを送信すると、このエンドポイントにやってきます。

07:38
So let's die and dump all of the request data.
> ということで、リクエストデータをdd()で表示してみましょう。

07:42
All right, magic, I'm going to fill out this form.
> それでは魔法を使ってこのフォームを埋めたいと思います。

07:44
All right, let's create the account.
> 出来ました、これでアカウントを作成します。

07:47
And there we go. We have our attributes.
> 表示されました。属性がセットされていますね。

07:49
while we're here, notice that logo is actually an instance of a Laravel class called uploaded file.
> これを見ると、ロゴがLaravelのUploadedFileというクラスのインスタンスになっていることが分かります。

07:55
And you're going to love this. It's going to make it as easy as possible to store this image wherever it needs to go, whether it's publicly available or even uploaded to Amazon S3 or something like that.
> このクラスはきっと気に入ると思います。これを使うと画像を保存するのがとても簡単になります。保存先が誰からでもアクセスできる場所であろうと、Amazon S3などのオンラインストレージにアップロードするのであろうと簡単です。

08:05
All right, let's get to work.
> では作業を続けましょう。

08:07
So this time, why don't we use request not as a helper function, but instead using an object instance like this.
> 今度は、ヘルパー関数を使ってリクエストを扱うのではなく、このようにオブジェクトのインスタンスとして扱ってみます。

08:14
So we are going to validate, and by the way, the API is identical.
> まずバリデーションを行います。使うAPI(validate())はヘルパー関数のときと同じです。

08:18
Okay, let's see if my editor can help me a little bit with the rules. We want to save time anywhere that we can.
> バリデーションルールを書くときに使えそうなエディタの機能がないか見てみましょう。いつでもできる限り時間を節約したいですから。

08:25
Yeah, it's not perfect, but it'll get us going.
> いいですね、完璧ではありませんが、これで続けられそうです。

08:27
Okay, so validate the name, the email, email verified at is not required nor as remember token, password is required and it should be confirmed, and then I'm going to use the password validation rule.
> ではバリデーションしていきましょう。まず名前とメールです。メールアドレス認証日とリメンバートークンには必要ありません、パスワードは必須で、確認が必要です。それからバリデーションルールのPasswordを使用しましょう。

08:41
Make sure you don't accidentally grab the password facade. You want to illuminate validation rules password, and I'll set the only requirement is it needs to be at least six characters.
> ファサードのPasswordと間違えないようにしてください。使うのはIlluminate\Validation\Rules\Passwordです。それを使って6文字以上とだけ設定します。

08:50
Next, what else? Email. Let's ignore the maximum for now. And it should be unique on the user's table and specifically on the email column.
> 他には、メールのルールを少し変えましょう。今は最大文字数は無視します。それから、usersテーブルのemailカラムの中でユニークであることとします。

09:00
This is actually automatic because it will fetch that from the name.
> 実際はこの'.email'は書かなくても構いません。キー名から自動で判別できるからです。

09:04
But if you want to be explicit, yeah. This is just saying, 'Hey look in the users table, and see if there's any email field that has the current email.'
> でも明示的にしたければ構いません。このように言っていることになります。「usersテーブルのemailフィールドの中に、このメールアドレスが入ってないか調べてくれ」

09:13
'And if there is, that's a no go. We can't have two users in the system with the exact same email address. It needs to be unique.'
> 「もし見つかったら、それはNGだ。システム内に、同じメールアドレスをもったユーザが２人いることはできない。１つだけでないといけないんだ。」

09:20
Okay, but next you'll remember we also have employer specific validation.
> では次ですが、雇用主に対するバリデーションも必要ですよね。

09:25
So we have a couple options. We could group them all together or what if we tried this.
> それにはいくつか方法があります。このグループ内に含めることもできますが、こうしてみるのはどうでしょうか。

09:30
Let's say user attributes, and then I will do another one for the employer.
> これを`$userAttributes`とします。そして雇用主用に別のものを用意します。

09:36
Like this, employer attributes.
> こちらは`$employerAttribute`とします。

09:38
And this can change to, and actually let's get a PHPStorm to do it.
> それから中を変更するのですが、PhpStormにやってもらいましょう。

09:44
Some rules for the employer.
> 雇用主用のルールを用意します。

09:46
And yeah, we just need this here.
> 必要なのはこの２つだけです。

09:48
Alright, so you have to give us a name and you have to give us a logo. We'll make that required for now.
> では、名前をロゴの入力を必須にするので、まずはrequiredを指定します。

09:53
But also I want to ensure that this logo is in fact an image. For that I can use a file rule, illuminate validation rules file, and let's set the available types.
> ですが、ロゴが画像であることも確かめたいので、Fileルールを使います。Illuminate\Validation\Rules\Fileです。これで使用可能なファイル形式をセットしましょう。

10:05
And yeah, you can give us a png, whatever you want here, jpg, webp, anything you want to add there.
> ここにpngなど好きな形式を指定することができます。jpgでもwebpでも追加したいものを指定してください。

10:11
Maybe a webp too and that'll be enough.
> webpもあったほうがいいですね。これでいいでしょう。

10:13
Now here's why we split it up.
> これを２つに分けた理由を今からお見せします。

10:15
I can now do things like this, user create user attributes, whereas otherwise I'd have to do something like array except or something like that to omit these from being passed to user create.
> ２つに分けたことによって、こんな風にすることができます。`User::create($userAttributes)`。そうでなければ、User::createに渡される前に配列から除外するとか取り除くとかいったことをする必要があります。

10:28
And the same for updating the employer. So this just makes it a little bit easier.
> 同じことが雇用主の更新にも言えます。こうしておくことで少し簡単になります。

10:33
Create a new user, then log in the user auth log in the user, and then yeah, let's create the employer, yeah we'll do that right here.
> ユーザを作成し、ログインさせるために`Auth::login($user)`とします。それから、そうです、雇用主を作りましょう。はい、ここで行います。

10:42
So we'll say user employer, create, and yeah, because we are accessing the create method in this way, it will automatically assign the user id to the employer record.
> `$user->employer()->create()`とします。このような書き方でcreateメソッドにアクセスすると、ユーザIDが雇用主のレコードに自動的にセットされます。

10:54
That way I don't have to manually set it, it happens automatically.
> こうすれば手動でセットする必要はありません。自動でやってくれます。

10:57
Now, we could do something like this, where we set employer attributes, but in this case we need to do a bit of work first for the logo.
> ここでこんな風に$employerAttributesをセットすることができます。ですがこの場合は、先にロゴについてやっておくべきことがあります。

11:05
I need to store the logo in the proper location, and then wherever that path is, I want that to be referenced within the employer's table record.
> ロゴは適切な場所に保存しなければいけません。そしてその場所がどこであれ、雇用主テーブルのレコードがら参照できるようにしたいと思います。

11:14
So here's what we'll do.
> このようにします。

11:15
Now you'll remember that the request logo field, when we saw it in the browser actually was an instance of Laravel's uploaded file class.
> リクエストの中のロゴフィールドは、ブラウザで確認したとき、LaravelのUploadedFileクラスのインスタンスだったのは覚えていますよね。

11:25
And that's really cool because now we have some behavior on that class to store the image wherever it needs to go.
> これは本当にクールなんです。なぜならそのクラスには画像をどこでも必要なところに保存できるメソッドがあるからです。

11:31
I'm going to put it in a folder called logos.
> これはlogosという名前のフォルダに保存しようと思います。

11:33
Okay, let's talk about this.
> では、これについてお話ししましょう。

11:35
If I go up into my configure directory, there is a file systems configuration file.
> configディレクトリに移動すると、filesystem設定ファイルがあります。

11:40
So this is for strorage.
> ストレージについての設定です。

11:42
Do we want to store files locally or with FTP or S3?
> ファイルはローカル環境に保存したいですか？それともFTPやS3を使いますか？

11:47
It just depends on what you want to do.
> それはあなたがどれにしたいかによります。

11:49
And I can see the settings for each of those discs or drivers here.
> それからここにディスクまたはドライバーごとの設定があります。

11:52
So yeah, in our case these will be publicly accessible avatars.
> 私たちの場合は、これらのファイルはみんながアクセスできるアバターになります。

11:57
So I want to use the public disc by default.
> ですので、デフォルトではpublicディスクを使いたいと思います。

12:00
So I can set that within my environment file. And yeah, notice file system disc, I will update this to public.
> それを環境ファイルで設定することができます。はい、FILESYSTEM_DISKがありました。これをpublicに変更します。

12:08
Alright, and that's it. Believe it or not, you're really going to love this.
> はい、これで終わりです。信じようと信じまいと、いずれこれが気に入るでしょう。

12:11
So when we upload the image, it will be saved within the storage app public and it will create a new logos folder.
> これで、画像をアップロードすると、storage/app/publicの中に新たにlogosフォルダが作成され、その中に保存されます。

12:18
And then we will create a symbolic link from here to the public directory so that any person can access these images.
> そしてそのシンボリックリンクをpublicディレクトリに作ることによって、これらの画像が誰からでもアクセスできるようになります。

12:25
That's the way that works. Alright.
> このような仕組みになっているのです。いいですね。

12:27
Now, once it uploads the image, it will save a path to where that logo is located.
> 画像がアップロードされると、そのロゴの保存場所へのパスが保存されます。

12:33
So I can then pass that to our create method.
> ですからそれをcreateメソッドに渡します。

12:38
Alright, so the employer's name will be employer attributes name or of course you can grab it right off the request.
> では、雇用主の名前は$employerAttributesのnameです。もちろんrequestから直接取り出すこともできます。

12:44
And then the logo will be, assuming we did everything properly, the logo path.
> それからロゴは、全部うまくいっていれば、ロゴのパスになります。

12:50
Alright, so validate all of the attributes, create a user, store the logo, create a new employer, and then how about redirect to the homepage?
> はい、これで、すべての属性のバリデーションをし、ユーザを作成し、ロゴを保存し、新たに雇用主も作成しました。その後はホームページにリダイレクトしましょうか。

13:00
Alright? Let me take a look at this. Good, good, good, good. and create.
> では、ちょっと確認させてください。よし、よし、よし、よし、それからcreateは、

13:05
Oh, actually no. Employer attributes should be employer. That was the name of the input we assigned within the view.
> あ、違います。$employerAttributesはemployerでした。ビューでinputにつけた名前はこっちでした。

13:12
Other than that, I think that looks pretty good.
> 他には、、、これでよさそうですね。

13:15
Alright, so it looks like we have only two actions here, so I can get rid of this and this.
> はい、ここで必要なアクションはこの２つだけのようなので、これとこれは取り除きます。

13:21
And yeah, from now on I will do this behind the scenes after the video, again to save us a little time.
> 今後、この作業は動画の後に裏でやっておくようにします。これも時間節約のためです。

13:27
Let's give it a shot.
> 動かしてみましょう。

13:29
All right, create the account, and it fails. Now maybe it wasn't called employer.
> いいですか、アカウントを作成してみると、あれ、失敗しました。employerが呼ばれてないようです。

13:34
Let's have a look. Let's go into register.
> 見てみましょう。registerから確認します。

13:36
Employer name? Yeah, employer logo. All right, let's go back to registered user controller.
> 雇用主の名前はemployerでこっちはlogo。合ってますね。RegisteredUserControllerを見てみましょう。

13:42
Ah, yes, I bet you saw that.
> ああ、これです。きっとみなさんは分かってましたよね。

13:44
Alright, so of course that key wasn't avaliable.
> はい、このキーは使えませんでした。

13:48
All right, try it one more time.
> もう一度やってみましょう。

13:49
All right, and there we go.
> はい、うまくいきました。

13:50
So yeah, I'd like to see a little more feedback and we can do that through flash messaging.
> ここで、もう少し操作のフィードバックが欲しければ、フラッシュメッセージを使うことができます。

13:54
But if I switch to users, sure enough, I have a new John Doe account, the password is hashed, and we also have an employer who belongs to that user.
> ですが、usersテーブルを確認すると新たにJohn Doeのアカウントがあり、パスワードはハッシュ化され、このユーザに紐づいた雇用主もできています。

14:04
So I think we're all set for registration.
> これで登録処理は完成といえるでしょう。

14:06
Next, I will switch over to login and log out.
> 次は、ログインとログアウトに取り掛かります。

14:10
So let's go into session controller. For create, this will hit auth dot login and let's create that.
> ではSessionControllerを開きましょう。createメソッドでは、auth.loginを表示します。これを作りましょう。

14;19
All right, so let's steal a liitle bit of the code here.
> では、ここでコードの一部を他から借りてきましょう。

14;24
So this will say login.
> ここを"ログイン"にします。

14:28
And this time we will post to login and there is no file input there.
> 今回は/loginにPOSTします。ファイル入力はありません。

14:33
Okay? I think all we need is an email address and a password. Alright.
> はい、必要なのはメールアドレスとパスワードだけです。

14:45
How's that look?
> どうでしょうか？

14:47
I think that's right.
> これでいいように思います。

14:48
Alright, back to session controller. That will now hit a store action.
> ではSessionControllerに戻ります。さっきのPOSTはstoreアクションにやってきます。

14:52
And you know what, we already wrote this functionality in the authentication episode.
> ところで、ここでやることは認証のエピソードですでに実装しましたよね。

14:56
So if I switch to GitHub, where we have the source code for the entire series, if I go into app, HTTP, session controller, I bet, yeah, let's take a look at this, it's all the same stuff, right?
> ですからGitHubを開きます。ここにこの全シリーズのソースコードがあります。このappの下のHttpの中にあるSessionControllerを開くと、はい、これを見てください。同じことをやっていますね。

15:11
Show the login view, validate the request.
> ログインビューを開いて、リクエストのバリデーションをしています。

15:14
So let's take the raw data here, copy it, and see if we can just paste it in here.
> ここから生データを開いて、コピーし、ここに貼り付けるだけでいけるか見てみましょう。

15:19
All right, so yeah, that looks pretty good.
> いいですね。よさそうです。

15:21
We try to log the user in, if we couldn't, then we attach a validation error to email.
> ユーザをログインさせようとして、できなければ、emailにバリデーションエラーをセットします。

15:27
We regenerate the session token as we've learned, that's a good practice. And thne we redirect again to the homepage in this case.
> セッショントークンを再生成します。これはいい習慣です。それからこの場合は、またホームページにリダイレクトしています。

15:34
And then finally for the story, you just do auth logout and redirect and you're done.
> それから最後に、Auth::logout()を行い、リダイレクトして終了です。

15:39
So that saves us a bit of time, which we needed.
> これでまた貴重な時間が節約できました。

15:42
Let's have a look. Let's go to slash login.
> 見てみましょう。/loginを開きます。

15:45
Let's try to log in <john@example.com>, and we're in.
> <john@example.com>でログインしてみましょう。できました。

15:50
All right, very cool.
> いいですね。とてもクールです。

15:51
But yeah, notice how if I visit slash login, I still see that form, which doesn't make sense.
> ですが、また/loginにアクセスしてみると、またフォームが出てきます。この動きはおかしいですね。

15:56
So let's do a little bit of authorization.
> ですので、少し認可をやってみましょう。

15:59
If you think about it, to access this page, you should be a guest.
> 考えてみてください。このページにアクセスするには、ゲストでなければいけません。

16:03
Same for this one, but not for this one.
> こちらも同じですが、これは違います。

16:06
Actually, in this case you need to be signed in.
> この場合はログインしていなければいけません。

16:08
So let's say middleware auth.
> ですので、`middleware('auth')`とします。

16:11
And then, for these two, and actually also for these two, you need to be a guest.
> それからこの２つ、そしてこっちの２つはゲストでなければいけません。

16:15
If you're signed in, it doesn't make sense to visit a register page.
> もしログインしているんであれば、登録ページにいくのはおかしいですから。

16:19
So I'm going to use a route group.
> ここではルートグループを使ってみたいと思います。

16:18
But first, add a middleware. And we'l say you've got to be a guest in order for this to work.
> ですが、まずはmiddlewareを追加して、ゲストでなければここに行けないようにします。

16:26
Okay? so now any route nested within this closure will receive the guest middleware.
> これで、このクロージャの中にネストされたルートはすべてゲストのmiddlewareを受けることになります。

16:32
This is a wrapper or instead, for each of these routes, we could do something like this and that would do the same thing.
> これはラッパーです。その代わりにそれぞれのルートに対してこのようなことをすれば同じことができます。

16:39
All right, very good.
> はい、よくできました。

16:40
Next, let's go into our layout file. And here is our nav section.
> 次はレイアウトファイルに移りましょう。ここがnavセクションです。

16:45
So yeah, right here, why don't we tweak this.
> そしてここです、ここを修正しましょう。

16:47
I only wnat to see this 'post a job' link if you're signed in. So I'm going to use this auth directive like so.
> この'求人を投稿する'はログインしているときだけしか見えないようにしたいので、@authディレクティブを使ってこのようにしたいと思います。

16:54
And then I'm going to add another one here called guest.
> それからここに@guestという別のディレクティブを追加します。

16:57
Now I could do auth else endauth but sometimes I think this reads a little bit better.
> @auth~@else~@endauthとすることもできますが、場合によってはこちらのほうが読みやすくなると思います。

17:02
If you're a guest, show this. If you're signed in, show that.
> ゲストであればこれを表示してください。ログインしていればそっちを表示してください。

17:06
And actually while we're here, why don't we say jobs slash create for the 'Post a job' link, because we know that's what it's going to be ultimately.
> それからついでに、'求人を投稿する'のリンクを/jobs/createにしておきましょう。最終的にこうなることが分かっているからです。

17:13
Okay? Now, if you're instead a guest, let's repeat some of this here.
> いいですか？今度は、ゲストの場合にはここのこれを繰り返すようにしましょう。

17:20
All right, so we will have two links to sing up or log in.
> はい、これでサインアップとログインのリンクができます。

17:29
All right, so sign up would be slash register and login would be slash login.
> サインアップは/registerで、ログインは/loginですね。

17:31
Let's have a look.
> 見てみましょう。

17:33
Okay, so if I refresh, yeah, I still see 'Post a Job' because of course I'm signed in.
> 画面を更新してみると、まだ'求人を投稿する'が見えています。ログインしているからです。

17:38
But let's open up an incognito window.
> ですが、シークレットウィンドウで開くと、

17:41
And yeah, now because we're not signed in, I do see signup and login and those do work. Perfect.
> このように今度はログインしていないのでサインアップとログインが見え、ちゃんと動作しています。完璧です。

17.47
Alright, so let's close those out and I'm back to the view where I'm signed in.
> ではこのウィンドウは閉じて、ログインしているビューに戻りましょう。

17:51
Alright, five second breather, real quick. I get it. I know I'm going really fast.
> それでは、ここで５秒間だけ休憩しましょう。はい、ペースが速すぎるのは分かっています。

17:56
Sorry, its going to be that way. It's day 30, we've got to wrap up. Okay, back to work.
> ごめんなさい、こうするしかないんです。今日が30日目なので最後までやってしまわないといけないんです。では作業に戻りましょう。

18:02
What should we work on next?
> 次に何をしなければいけないでしょうか？

18:04
How about this big search bar here?
> この大きな検索バーにしましょうか？

18:06
Yeah, Okay, let's go into jobs slash index and let's see what we have.
> そうしましょう。では/jobs/indexを開いて何があるか見てみます。

18:12
Yeah, right now we have standard form tags.
> はい、今は普通のフォームタグがあります。

18:15
But I'm going to replace this with our new x forms dot form tag.
> でもこれを私たちが新たに用意したx-forms.formタグに置き換えましょう。

18:19
And this will make a get request, which is the default, but I want to send it to, how about search? And we will implement that route.
> これはデフォルトではGETリクエストを送りますが、送り先を/searchにしましょうか。あとでこのルートを実装しましょう。

18:27
All right, next within here, let's add an input.
> 続いてここにinputを追加しましょう。

18:30
The name will be q for query. That's really common.
> 名前はクエリ－の'q'にしましょう。これはよく使われます。

18:33
The placeholder can be something like web developer.
> プレースホルダーは'Web開発者'にでもしておきましょう。

18:37
And let's have a look in the browser.
> ではブラウザで見てみましょう。

16:39
I get undefined variable label.
> 未定義の変数labelと出てきました。

18:42
So my input component is expecting a label, but in this case, we don't actually want one.
> 私のinputコンポーネントにはlabelを指定する必要があるんですが、ここではラベルはいりません。

18:48
So if I switch through, we can see that the label is passed to this field component.
> コンポーネントに移動してみると、labelがfieldコンポーネントに渡されています。

18:56
And the field component checks whether label is truthy.
> そしてfieldコンポーネントではlabelの存在チェックをしています。

19:00
Okay, so if I switch back, all I need to do is set label to false.
> では戻ります。やらなければいけないのは、labelにfalseをセットすることです。

19:07
All right, switch back and that solves that problem.
> これで戻ってみると、問題は解決されています。

19:10
Okay, I think I need a little more breathing room below the title.
> タイトルの下にもう少し余裕があった方がいいように思いますね。

19:13
So why don't we say class of mt-6.
> ですからmt-6というクラスをつけてみましょう。

19:16
And yeah, we kind of reproduced what we had before. Cool.
> はい、以前作ったものを再現できましたね。クールです。

19:20
So now, yeah, take a look.
> では見てみましょう。

19:21
If I search for how about laracasts and I hit submit, I do get a 404, because I haven't yet implemented that route.
> 'laracasts'で検索して送信してみると、404が返ってきました。このルートはまだ実装していないからです。

19:30
All right, let's do it now. let's duplicate this.
> では今から実装しましょう。これを複製します。

19:33
If you visit slash search, agian, keep it very simple, let's load, a search controller.
> /searchにアクセスすると、これもシンプルに、SearchControllerをロードするようにしましょう。

19:40
And actually this time I'm going to show you invocalble controllers.
> 今回はシングルアクションコントローラをお見せします。

19:44
So every once in a while you'll have a controller that will only ever have one action.
> 時々、アクションが１つしかないコントローラを使うことがあります。

19:49
In these cases, rather than passing an array and to the action name, you can just pass the path to the class itself.
> そのような場合には、配列を渡してアクション名を指定する代わりに、単にクラス自身のパスを渡すことができます。

19:57
And then an invoke magic method will be called on that class.
> すると、そのクラスのinvokeという不思議なメソッドが呼ばれます。

20:02
It's pretty cool. Let's do that now.
> とてもクールです。やってみましょう。

20:03
Php artisan make me a controller called search controller.
> php aritsanでSearchControllerというコントローラを作ります。

20:07
And oh, you know what, that's interfering with my route declaration.
> すると、ほら見てください、私のルート定義と矛盾して失敗しました。

20:11
So let's do that first and then uncommon to this.
> ですのでこれをコメントアウトしておいて先にコントローラを作成してから、コメントを外しましょう。

20:14
Okay, now I can import it and I will command click through.
> ではこれをインポートして、Command + クリックでそのファイルに移動しましょう。

20:17
And yeah, if I create a magic underscore underscore invoke method, now this will be called.
> ここで不思議な__invokeメソッドを作ると、ルート定義からこのメソッドが呼ばれるようになります。

20:25
And yeah, this is, this is great for situations where a controller only ever needs to have one action.
> これはコントローラが１つのアクションしか必要としない場合に最適です。

20:31
So I'll show you, come back, givi it a refresh, and we now have hit that invoke method, okay.
> ではお見せしましょう。戻って更新します。するとinvokeメソッドが呼び出されたのが分かります。いいですね。

20:37
So there should be a q, query within the request.
> リクエストには'q'つまりクエリ－が含まれていなければいけません。

20:43
Refresh, and now that is set laracast. And of course we can control that here.
> 更新して確認すると、今は'laracast'とセットされています。これはもちろんここで変更することができます。

20:49
Cool. So now we have everything we need to search our jobs table.
> いいですね。これでjobsテーブルを検索するのに必要なものはすべて揃いました。

20:53
And this will be fairly primitive.
> ただし、これはかなり原始的なものになります。

20:54
We're not going to use full text search or anything special.
> 全文検索や何か特別な検索は行いません。

20:57
We'll just say look for any job where the title is like this seach param and that should be enough.
> 検索パラメータのような求人のタイトルを探すだけにします。それで十分でしょう。

21:05
So let's say job where the title is like the request query,
> このように書くことができます。`Job::where('title', 'LIKE', request('q'))`。

21:12
But then I'm going to say, yeah, any number of characters can come before that query and any number of characters can come after it.
> さらに、クエリ－の前にも後ろにも、どんな文字がいくつくっついてもいいこととします。

21:18
So as long as this search query exists somewhere within the title, I want it included in the result set.
> そうすることで、タイトルのどこか一部に検索クエリ－が含まれているだけ場合も、検索結果に含めたいと思います。

21:25
So we will fetch that, and then why don't we return that as json, so we can have a look in the browser.
> ではその結果を取得し、JSON形式にして返してみましょう。そうすればブラウザで確認することができます。

21:31
Let's start from scratch. Let's look for something related to, how about teacher.
> 最初からやってみましょう。そうですね、teacherに関連するものを探しましょう。

21:35
All right, we run it, let's do pretty print, and we get one result.
> では実行します。Pretty-printを使いましょう。1つ見つかりました。

21:39
Alright, so now we just need to render a view to display those results and that should be pretty easy.
> 今度はこれらの結果を表示するビューを作る必要がありますが、とても簡単にできます。

21:45
Let's return a view.
> viewメソッドを返すようにしましょう。

21:47
And this could be like a generic view like results. Anytime you want to show jobs, we can use this view.
> これはresultsというような一般的なビューにすることができます。複数の求人を表示したいときは、いつでもこのビューを使うことができます。

21:53
And I'll pass through our list of jobs. Nice and easy.
> これには求人のリストを渡すようにしましょう。簡単で分かりやすいですね。

21:57
Alright, let's have my editor create the view.
> では、私のエディターにこのビューを作ってもらいましょう。

22:01
We'll have our layout, we will have a page heading, results.
> レイアウトの中にページヘッダを用意して'結果'とします。

22:05
And then let's do this. Let's go into jobs slash index.
> それからこうしましょう。jobs/indexに移動します。

22:10
And yeah, we want this right here.
> ええと、はい、ここにあるこれです。

22:13
So I'm going to copy this and paste it in.
> これをコピーして、ここに貼り付けます。

22:17
And I don't think we need that mt-6 in this case.
> ここではmt-6は必要ないでしょう。

22:20
Alright, yeah, let's have a look.
> では見てみましょう。

22:23
Back to the browser, refresh. And we have only one result, but it does seem to be working.
> ブラウザに戻って更新します。すると結果は１つだけですが、たしかに動作しています。

22:28
Let's try one more time. Something related to tax.
> もう一度やってみましょう。Taxに関係するものを検索します。

22:32
And once again we have one result, but yeah, that's working.
> また結果は１つですが、動作しています。

22:35
Cool. Search is now done. At least the primitive form of search is now complete.
> クールですね。検索が完成しました。少なくとも原始的な検索処理は完了です。

22:40
We should also look for tags and things like that, but you can work on that on your own.
> タグとかそういったものでも検索できるようにすべきですが、それはみなさん個人で取り組んでください。

22:45
So now think about it. If we go back to our routes file, let's set up another route for tagging.
> 今度はこれについて考えてみてください。ルートファイルに戻って、タグ付けされたもののための別ルートを設定しましょう。

22:51
So I could say visit tags slash, and then some kind of tag name, that will hit a tag controller.
> /tags/に続いてタグ名を指定してアクセスすると、TagControllerが実行されるようにします。

22:58
And I will create that. So make me a controller called tag controller.
> このクラスを作成しましょう。TagControllerという名前のコントローラを作ります。

23:03
Cool.
> いいですね。

23:05
And let's import that.
> インポートしましょう。

23:09
And yeah, this'll be the exact same thing.
> これはさっきと全く同じものになるでしょう。

23:11
So in fact if I go to search controller, let's just copy that, switch back to tag, paste it in.
> ですからSearchControllerに移動して、これをそのままコピーし、タグに戻って、貼り付けます。

23:16
And now we aren't searching the database, we are finding all jobs associated with a given tag.
> 今度はデータベースを検索するのではなく、与えられたタグに紐づいた求人をすべて取ってきます。

23:25
Something like that.
> こんな感じです。

23:26
Okay, so let's go to our tag model.
> ではTagモデルに移動しましょう。

23:28
And we don't yet have a relationship between a tag and a job, but I think we do in reverse.
> タグから求人へのリレーションはまだありませんが、逆は定義していたと思います。

23:34
Yes. So let's copy this, bring it over to tag, paste it in.
> ありました。これをコピーして、タグに持ってきて、貼り付けましょう。

23:40
And now if I have a tag and I want to find all jobs, it's also a belongs to relationship. We just have to reverse it, like that.
> タグがあってその求人をすべて取得したいとしたら、それもBelongsToManyリレーションになります。ですから入れ替えるだけです。このように。

23:49
All right, back to tag controller.
> ではTagControllerに戻ります。

23:51
Alright, well now I'm going to ask for the tag. And you learned about this through route model binding.
> ここでタグを受け取るようにします。ルートモデルバインディングでこのことを学びましたね。

23:57
Just as a five second recap.
> 5秒で要約します。

23:59
Yeah, right here. Because we have this wild card here that's called tag, and then we have a parameter name also of tag, Laravel is going to try to track down this tag for us.
> ここです。ここにtagという名前のワイルドカードがあり、こちらのメソッドにもtagという名前のパラメータがあるので、Laravelはこのtagを追跡しようとします。

24:10
But by default, it's going to expect this wild card to be an id.
> ですがデフォルトでは、このワイルドカードにはidが指定されると想定されています。

24:14
So I can add a colon and say 'No, actually the identifier here is name'.
> ですからここにコロンをつけて、「いいえ、ここの識別子はnameです」と指示します。

24:18
So, if I visit tags slash frontend, yeah, I basically want Laravel to say 'Select star from tags where name equals fronend'.
> つまり、/tags/frontend にアクセスすると、Laravelに「名前がfrontendというタグを全て選んでください」と言っていることになります。

24:28
Yeah, without that, it would default to this.
> その指示がなければ、デフォルトではこう(tag:id)なっています。

24:31
And yeah, we already reviewed this, so that should be a recap.
> これについてはすでにやったことがあるので、再確認したまでです。

24:35
All right, so now I should have the tag, I should be able to get the jobs for the tag, right?
> はい、これでタグが受け取れるようになったので、そのタグがつけられた求人を取得することができますよね。

24:40
So why don't we just do this.
> ではこうしてみましょう。

24:42
Load the results and pass through all of the jobs associated with this particular tag.
> 'results'をを通してこのタグに紐づけられたすべての求人を読み込みます。

24:48
Alright, let's clean up.
> コードを整えておきましょう。

24:50
And it's so easy, isn't it? It kind of blows me away. It's so simple.
> 簡単でしたよね？ちょっと驚かされます。とてもシンプルです。

24:54
Alright, back to the browser and let's visit some random tag. How about ut?
> ではブラウザに戻って、適当にタグを見てみましょう。utはどうでしょうか？

25:02
All right, and here are all of the jobs that are associated with that particular tag.
> はい、そのタグに紐づけられたすべての求人が出ています。

25:07
Yeah, cool.
> クールですね。

25:08
So now, yeah, all of these tags should be clickable. So if I click here, that will show me all of the jobs so that I can further filter things down. That's great.
> 今、これらのタグはすべてクリックできるようになっています。ですからここをクリックすればその求人がすべて表示され、さらに絞り込むことができます。素晴らしいですね。

25:17
Okay, final thing and then I promise we're going to be done.
> それでは最後の作業です。これで完了することをお約束します。

25:20
Of course we need to implement the form to post a job.
> 当然私たちは、求人を投稿するフォームを実装しなければいけません。

25:23
So let's do that now. Go to my routes file.
> 今からそれに取り掛かりましょう。ルートファイルを開きます。

25:27
And we'll say right up here, how about this? Let's duplicate this, jobs slash create. We'll hit job controller at create, and then I'll do another one here.
> ここにこう書いてみましょう。これを複製して、/jobs/createとし、JobControllerのcreateを割り当てます。それからここにもう１つ追加しましょう。

25:37
When you make a post request to slash jobs, that should store a new job in the database.
> /jobsにPOSTリクエストを送ったときは、データベースに新しい求人を保存するようにします。

25:43
And of course these need to have the proper middleware.
> それからもちろんこれらには適切なミドルウェアをつけなければいけません。

25:46
In order to post a job, you need to be signed in.
> 求人を投稿するには、ログインしている必要があります。

25:50
Alright, let's take care of it.
> ではこれらを実装していきます。

25:51
So we have our create action, that will return jobs dot create.
> createアクションがあります。これはjobs.createビューを返します。

25:57
Let's have my editor create the view, x-layout, notice how quick we can be, when we have our systems in order, right?
> エディターにビューファイルを作ってもらいましょう。x-layoutを配置します。どうですか？きちんと順を追ってシステムを作っていくと、こんなにスムーズに進められるんです。

26:06
Let's do a page heading, new job, and sanity check. Let's load the page jobs slash create, and that works.
> ページヘッダを「新規の求人」として、確認してみましょう。jobs/createを開くと、うまくいってますね。

26:15
And further, if I clkck right here, it should load it. Cool, let's build our form.
> さらにここをクリックしても開くはずです。いいですね。ではフォームを作っていきましょう。

26:21
Now, this is going to make a post request to slash jobs.
> これは/jobsにPOSTリクエストを送ります。

26:26
And let's do this. Again, I'm going to save ourselves some time. You've already seen the basic process of creating a form input. So I'll paste in a few at once.
> それから、また時間の節約のためにこうしましょう。入力フォーム作成の基本的な進め方は既に見たことがありますね。ということでいくつかまとめて貼り付けます。

26:35
So we have one input for the title and a salary and a location.
> タイトルと給与と勤務地の入力欄ができました。

26:39
Next, we need one for the URL. So this is the URL to view the actual job page on your company's website.
> 次はURLの入力欄です。これはあなたの会社のサイトに掲載されている求人ページのURLです。

26:46
Next, when you create a job, you can optionally add a number of tags.
> 次です。求人を作る時に、いくつかタグをつけることができます。

26:51
So I'm going to keep this very simple, it's just an input. And if you provide a comma separated list, we will turn those into tags.
> シンプルにするために、これは単なるテキスト入力にします。そこにカンマ区切りで複数のタグを入力すると、それを個別のタグに分割するようにします。

26:57
Maybe not ideal, but it'll get the job done in this case.
> 理想的とは言えないかもしれませんが、この場合はこれで十分でしょう。

27:01
Next, I'm going to have a button to publish the job.
> 次に求人を公開するボタンを用意します。

27:05
And then I'm going to introduce a new one, which is a select field.
> それから新しいフォーム部品を紹介しましょう。選択フィールドです。

27:10
So if I have a look at it real quick, yeah, notice it's just deferring to an HTML select.
> 少し中をのぞいてみると、単にHTMLのselectタグを使っているだけです。

27:15
All right, so our options are part-time and full-time. And this is where you specify what the schedule for the job is.
> このオプションは「パートタイム」と「フルタイム」にしています。ここで求人のスケジュールを選択します。

27:23
Next, right down here, let's add it.
> 次は、この下にこれを追加します。

27:26
I'm going to add a checkbox. Once again, input and type equals checkbox. Very basic stuff.
> チェックボックスを追加します。これも中をのぞいてみると、inputタグでtypeがcheckboxです。ごく一般的なものです。

27:32
Okay, so the label for the checkbox is feature and cost extra. Yeah, presumably if you built this on your own, in order to feature a job, you're going to be charged a hundred dollars or twenty dollars, whatever it is.
> そのラベルは「フィーチャーする（追加料金が必要）」としています。おそらくこの機能を自分で実装するときは、求人をフィーチャーさせると、100ドルとか20ドルとかいくらか請求されるようにするでしょう。

27:46
We would want to note to that, but yeah, we're not going to deal with billing or stripe in this series. It's far beyond the scope of this course.
> このように注意書きしておいたほうがいいと思います。ですが、このシリーズでは請求やStripe決済は扱いません。このコースの範囲をはるかに超えた内容です。

27:53
Anyways, I think that's it.
> とにかく、これで全部だと思います。

27:54
So the only thing I might do is add a divider to separate the main fields from the optional tags.
> 後は、メインのフィールドとオプションのタグとを分ける区切り線だけ追加しておきたいと思います。

28:01
All right, let's have a look in the browser.
> ではブラウザで見てみましょう。

28:04
And here we go. To create a new job, you've got to give us all of this junk here, and then you can publish it.
> この通りです。新しく求人を作るには、このごちゃごちゃしたものを全部入力しなければいけません。それから公開することができます。

28:10
All right, so that's going to make a post request to slash jobs.
> いいですね。ところで、これは/jobsにPOSTリクエストを送るようになっています。

28:14
That will hit our job controller, and that will load this action.
> このリクエストはJobControllerに送られ、このアクションが実行されます。

28:18
Now you can see here we have a form request. I actually didn't review that in this course.
> ここでフォームリクエストを受け取っています。このフォームリクエストについては、このコースでは扱ったことがありません。

28:24
Some people like them, some people don't.
> 好む人もいますし、そうでない人もいます。

28:25
I would encourage you to take a look at theme, but for now I'm not going to dig into anything new.
> フォームリクエストについてはぜひご自分で調べてみていただきたいんですが、今は新しいことには首を突っ込まないようにします。

28:30
So let's stick with the standard illuminate HTTP request.
> ですので標準的なIlluminate\Http\Requestを使うようにします。

28:34
Alright, let's get to work.
> では作業を始めましょう。

28:35
We will validate the request. Let's see what my editor can do for me.
> リクエストのバリデーションを行います。エディタがどこまでやってくれるか見てみましょう。

28:39
I'm going to add a new job. Yeah, pretty good.
> Jobクラスを追加すると、こうなりました。とてもいいですね。

28:42
I will take care of the employer id. So you need to give us a title, a salary, a location, a schedule.
> 雇用主IDは自分で設定します。ですから必要なのは、タイトルと給与、勤務地、スケジュールです。

28:49
And then for our demo at least we're saying, well the schedule needs to be either part-time or full-time.
> それからこのデモでは、スケジュールは「パートタイム」か「フルタイム」のどちらかとしています。

28:54
So one way we can do that is through the illuminate validation rule class. And I can say it needs to be, the attribute value needs to be included in one of these.
> それをチェックする方法の１つはIlluminate\Validation\Ruleクラスを使う方法です。この属性の値はこれらのうちのいずれかでなければいけないとすることができます。

29:05
And we can also set this up as enum if we want, but I'm not going to.
> やりたければ、これをEnumで設定することもできますが、ここはこのままにしておきます。

29:08
All right, next step. The URL is required and it should be a URL or if you want to make sure it's an active URL, you could do that as well, which is cool.
> では次にいきましょう。URLは必須でURL形式でなければいけません。または有効なURLでなければならないとするなら、'active_url'とすることもできます。クールですね。

29:17
And then featured, I will handle that a little differently.
> それから'featured'です。これはちょっと別のやり方で扱います。

29:20
Finally, we have tags and we'll keep it here.
> 最後です。タグはここで扱います。

29:23
And let's say tags actually can be nullable.
> タグは省略可にしましょう。

29:26
All right. Next I will say that to attributes and then I will manually handle the featured status.
> はい。では次にこれを$attributesに代入し、'featured'の状態を手動で設定します。

29:31
So I could say, okay attributtes, add a new one called featured, and that will be true or false depending on whether the request has a value for that featured checkbox.
> $attributesに'featured'という属性を追加し、リクエストにfeaturedチェックボックスの値が設定されているかどうかに応じてtrueかfalseを設定します。

29:42
Remember, if that input ins't checked, I don't think anything gets passed, right?
> 覚えておいてください。チェックボックスがチェックされなければ、その属性自体も渡されません。

29:45
But if it is checked, it's set to on or something like that.
> ですがチェックされれば、そこにはonとかそういう値がセットされて渡されます。

29:49
All I want in this case is a boolean. So we will use that.
> ここで私が欲しいのはブール値なので、このようにしました。

29:53
Alright, this looks good to me.
> はい、これでよさそうですね。

29:54
So let's go through the authenticated user, lets's grab the employer, we'll reference the jobs relationship and create a new one there.
> ではログインユーザから雇用主を取得し、求人のリレーションを使って、そこで新しい求人を作成しましょう。

30:02
And again, to be crystal clear, when we take this pathway, when we create the job, the employer ID will automatically be set in the process.
> 分かるようにもう一度言っておきますが、この方法で求人を作成すると、雇用主IDがその過程で自動的にセットされます。

30:12
And further, when we access the employer through the authenticated user, we remove any opportunity to fake who the current user is.
> さらに、ログインユーザを通じて雇用主にアクセスすれば、他のユーザに求人を作成されるという可能性もなくすことができます。

30:20
Unless you're signed in, you have no ability to create a job under a different employer.
> ログインしていなければ、別の雇用主として求人を作成することはできません。

30:25
Okay, so it sounds like we just need all of these attributes, maybe except the tags.
> はい、これを見ると、タグを除いたすべての属性が必要なようです。

30:30
So here's what I'll do.
> ですのでこのようにします。

30:31
This time, array except, and I'll provide the attributes and then the one that I want to exclude.
> 今回は`Arr:except()`を使います。$attributesと、それに続いて、除外したいものを渡します。

30:39
We could do that or we could access it through the request.
> このようにするか、もしくはrequestを通じてアクセスすることもできます。

30:42
I think there's a request unless or a request except method as well.
> requestにもunlessかexceptというメソッドがあったと思います。

30:46
So either of those would work.
> どちらの方法でも可能です。

30:48
All right, now we have a new job record.
> これで新しくJobレコードができました。

30:50
The final step is tags.
> 最後はタグです。

30:52
So why don't we do this?
> こうしてみてはどうでしょうか？

30:53
Let's see, do we have any tags at all?
> まずタグがセットされているかを見てみましょう。

30:56
And what we'll say is if we don't have anything there, let's just assume false.
> そしてこう続けます。もしセットされていなければ、falseとしましょう。

31:00
I'm not sure if that's necessary. We might be able to remove that, but I'm going to keep it.
> 後ろの部分は冗長かもしれません。つけなくてもいいかもしれませんが、残しておきましょう。

31:04
Then what I'm going to do is basically explode that list of tags using a comma as separator. Something like this.
> そしてこの中で、タグのリストをコンマを区切り文字に指定して文字列分割します。このような感じです。

31:12
So now laravel, backend, frontend, that will turn into an array, right?, of laravel, backend, you get the idea.
> "laravel,backend,frontend"というような文字列が配列になります。['laravel', 'backend',,,]分かりますよね。

31:20
Let's then loop over it. So for each of those as tag, then let's create a new tag.
> その配列を順に取り出します。それぞれを$tagとして、新たにタグを作成しましょう。

31:27
So I need a job instance. We got it here.
> それにはJobのインスタンスが必要なので、ここから取得します。

31:30
And I can say job tag. And yeah, you'll remember, using TDD we implemented this tag method.
> そして`$job->tag()`とすることができます。覚えていますよね、TDDでこのtagメソッドを実装しました。

31:37
And this will try to find a tag with the name and attach it.
> このメソッドは、指定された名前のタグを見つけてそれを紐付けてくれます。

31:40
Otherwise it'll create a brand new tag in the database with that name.
> もし見つからなければ、その名前のタグを作成しデータベースに保存します。

31:43
So yeah, on this note, keep in mind, this is fairly primitive.
> これは極めて原始的なやり方だということを覚えておいてください。

31:47
We could end up in situations where, for example, you have a tag called frontend in the table, but then this as well.
> こんなことになる可能性があります。例えばテーブルに'frontend'と'front-end'が別々に保存されてしまったりです。

31:55
And we should consolidate that as much as we can, but we're going to take a shortcut where we can find it.
> そういったものはできるだけ統合すべきですが、ここは近道を使ってあるかどうかだけを見るようにしましょう。

32:00
Alright, let's pass it in.
> ではタグ名を渡しましょう。

32:02
And I think we're done. So let's redirect to the home page when we're done.
> これで以上ですね。できたらホームページにリダイレクトしましょう。

32:09
Okay, let's get rid of all of these.
> では、これらは全部削除します。

32:11
And this is our, let's clean this up, this is our job controller.
> これが私たちの、あ、コードを整理しておきましょう、これが私たちのJobControllerです。

32:17
All right, let's go. Post a job.
> では確認してみましょう。求人を投稿します。

32:19
I'll fill this out like magic, like so.
> 魔法を使ってこれらを入力します。この通り。

32:22
Alright, so we have a position for laracasts video editer, pays 90 grand, here's the link to the work page. And here are some optional tags.
> Laracastの動画編集の仕事で給料は９万ドル、これが求人ページへのリンクで、ここにオプションのタグがいくつか入っています。

32:31
Let's publish it.
> 公開してみましょう。

32:33
Alright, I would expect to see it right here, right? Well, let's see, where is it?
> ここに表示されて欲しかったんですが、見てみましょう。どこにあるんでしょうか？

32:37
Ah, it's at the end of recent jobs.
> ああ、最近の求人の一番下にありました。

32:39
Here's what I think I did wrong.
> 多分ここで間違ったんだと思います。

32:41
Let's go into job controller, and maybe I got the order wrong.
> JobControllerに移動しましょう。おそらく順序付けを間違えました。

32:46
Maybe recent jobs is actually first and featured is second.
> 最近の求人が先で、注目の求人が後ですね。

32:52
Yeah, I bet that's what I did.
> はい、きっとそのはずです。

32:54
Okay, back to arc.
> ではサイトに戻って確認しましょう。

32:56
Give it a refresh. And again, I don't see it here, but I do see it at the end.
> 更新します。そしてまた、ここには見当たりません。でも、最後にありました。

33:01
Okay, so we just need to reverse the order.
> ということは順番を逆にすればいいですね。

33:04
Why don't we say the newest jobs show up top.
> 最新の求人が先頭に表示されるようにしましょう。

33:07
Job, I want the latest ones and give me the results, and group them according to whether they are featured or not.
> Jobに対してlatestメソッドで最新順に並べ替えて結果をgetで取得し、featuredでグループ分けします。

33:14
And that should do it. Come back, refresh. And there we go. We have our brand new job.
> これでいいはずです。戻って更新すると、ほらこの通り。最新の求人が先頭に来ています。

33:20
So let's see, can I view all jobs associated with that tag? Yes I can.
> では見てみましょう。このタグがつけられた求人をすべて見ることはできるでしょうか？はい、できます。

33:25
Now, I should be able to click on the job and it will take me to the job listing page.
> 次は、求人をクリックすると求人リストページ（※求人の詳細ページの誤り）に遷移できるようにしなければいけません。

33:30
Let's fix that and then I promise we are done.
> これを修正しましょう。そうすれば完成です。お約束します。

33:34
Alright, so here is the h3.
> ここにh3タグがあります。

33:37
It's now going to be an anchor tag that links to the job's URL, like so.
> これをアンカータグに変更しましょう。リンク先は求人のURLです。こんな感じです。

33:46
So let's do the same thing for job card wide.
> 同じことを横長の求人カードにも行いましょう。

33:52
Like so. And cross your fingers, refresh, click on this, and it loads the laracasts page where you can view more details.
> こんな風に。うまくいくよう祈りながら更新します。これをクリックすると、Laracastのページが表示されました。そこで詳細を見ることができます。

34:02
The only thing you might want to do is set a target of blank for both of these. Switch over to this one as well.
> 後は、targetを_blankにセットしておきましょう。こちらも同じようにします。

34:10
And that way some people don't like this, but in this scenario, I think it's okay.
> これを好まない人もいますが、このシナリオでは構わないでしょう。

34:13
That way the user doesn't completely abandon your jobs page.
> こうすれば閲覧中の求人ページを閉じてしまわなくて済みます。

34:17
It instead opens the job within a new tab.
> こうすると求人ページが新しいタブで開かれます。

34:20
So again, imagine you're looking for jobs related to video work.
> もう一度やってみましょう。動画関連の仕事を探しているとします。

34:24
All right, here we go. Click on it. And now we can review more.
> こんな求人がでてるのか。見てみよう。クリックします。このようにして詳細を確認できます。

34:28
And ladies and gentlemen, that is all I'm going to cover today.
> そしてみなさん、今日取り上げるのは以上です。

34:32
Oh wait, actually no, no, no. I have two more things, sorry, two more things to show you.
> ああ待って、違います、違います。ごめんなさい。後２つお見せするものがありました。

34:37
We have to update the job card to show the new employer logo.
> 新しい雇用主のロゴを表示するために求人カードを更新する必要があります。

34:41
And then I also want to display a logout link and make a couple tweaks to make our query performance better.
> それからログアウトのリンクを表示して、あとはデータベースへの問い合わせのパフォーマンスを向上させるためにいくつか修正したいと思います。

34:46
All right, let's go into employer logo.
> では、employer-logoを開きましょう。

34:49
And yeah, right now we are hard coding the path, but now we can swap it out with the employer logo.
> 今はパスをハードコーディングしているので、これを$employer->logoと置き換えましょう。

34:57
Okay, so now let's ask for an employer when you load this component.
> 次は、このコンポーネントをロードするときに雇用主を受け取るようにしましょう。

35:01
Okay, I believe we've referenced it in job card.
> これは求人カードから参照していたはずです。

35:04
Yep, let's pass through the employer, job employer, and then I think we do the exact same thing in job card wide.
> ありました。:employerで$job->employerを渡しましょう。幅広の求人カードでも同じことを行います。

35:12
So I'll paste that in and remove the width.
> これを貼り付けて、widthを削除します。

35:16
Okay, so now let's switch into our component.
> では、今度はコンポーネントを開きましょう。

35:18
And I'm going to pass this to Laravel asset function and that will prepare a full URL to the asset.
> これをLaravelのasset関数に渡します。するとこの関数はアセットの完全なURLを返します。

35:25
And remember, when you upload a logo, it goes into the storage app public logos directory.
> 覚えていますか、ロゴをアップロードすると、storage/app/public/logosディレクトリに保存されます。

35:33
So here's one of the logos I uploaded.
> これは私がアップロードしたロゴの１つです。

35:36
And now all you have to do is symlink it into your public folder, which is globally accessible.
> ここでしなければいけないことは、みんなが閲覧可能なpublicフォルダに、このフォルダのシンボリックリンクを作成することです。

35:41
So for that you can say php artisan storage link.
> そのために、`php artisan storage:link`を実行します。

35:45
All right, so now notice we have a symbolic link right here.
> これでここにシンボリックリンクが作られました。

35:49
Yeah, there it is. And now they're accessible.
> これでこのフォルダの中身にアクセス可能となりました。

35:52
All right, let's go to arc and we see it, but the size is wrong.
> ではサイトに戻ってみると、表示されていますが、サイズがおかしいです。

35:56
All right, let's go into employer logo.
> ではemployer-logoを開きましょう。

35:58
And yet we accept a width, but we never used it. So let's do that now.
> widthを受け取るようになっていますが、使っていませんでした。修正しましょう。

36:02
Come back and that looks good to me.
> 戻って確認すると、よさそうですね。

36:06
Alright, next. Let's go into job controller.
> では次です。JobControllerを開きましょう。

36:08
And remember to always optimize your queries.
> 常にクエリ－を最適化することを忘れないでください。

36:11
If we have a job and we're going to access tags and employer information of it, if we're not careful, that's going to lead to an N+1 problem as we learned about.
> 求人があって、そのタグと雇用主の情報にアクセスするときは、気を付けていないと、以前学んだN+1問題につながってしまします。

36:20
So let's always use the with method to eager load any relationships we require, such as employer and tags.
> ですので、常にwithメソッドを使って、雇用主やタグといった必要なリレーションをイーガーロードするようにしましょう。

36:28
And yeah, you would also do the same thing, for example in search controller.
> それから同じことを、例えばSearchControllerでも行います。

36:33
So make sure you say with employer and tags and whatever else you happen to reference.
> withメソッドで、雇用主にタグにその他何でも参照するものをロードするようにしてください。

36:39
And when these queries get a little long, yeah, make sure you can put them on their own line.
> それによってクエリ－が長くなるようであれば、それぞれ個別の行にすることもできます。

36:43
And if you want, you can even call this query method to start a new query.
> またはqueryメソッドを呼んで、新しくクエリ－を開始することもできます。

36:47
And that allows you to keep all of your primary filter methods on their own lines and that does the same thing.
> そうすることで主要なフィルターメソッドをそれぞれ個別の行に並べることもできます。どちらも同じ動きになります。

36:54
Alright, last thing and then I promise this time I'm letting you go.
> では最後です。今度こそあなたを解放すると約束します。

36:58
If we swtich to arc, yes, we have sign up and log in, but if I log in as John, there's no link to log out.
> サイトに戻ってみると、サインインとログインが表示されています。ですがJohnとしてログインすると、ログアウトのリンクがありません。

37:07
So that's my final step.
> これが最後のステップです。

37:09
If you're signed in, I'm going to add a form to logout. That'll hit the logout endpoint and it's going to make a post request.
> ログインしたら、ログアウトのフォームを追加しましょう。/logoutエンドポイントへ向けてPOSTリクエストを行います。

37:21
But of course we need to add the CSRF and method tags. And yeah, we're not using the form component because that has some styling for the form itself and the button. And we don't need that in this case.
> ですが、もちろんCSRFとメソッドディレクティブを追加しなければいけません。それからformコンポーネントは使用しません。フォーム自体やボタンにスタイルがセットされているからです。このケースではそのようなスタイルはいりません。

37:32
Okay. So yeah, now let's do a display of flex.
> はい、そうですね、Flexディスプレイを適用しましょう。

37:38
And yeah, it looks good to me.
> はい、これでよさそうです。

37:40
So I can post a job or I can log out.
> これで求人を投稿したり、ログアウトしたりできます。

37:43
And this time, ladies and gentlemen, I'm done. I can't do anymore in this course.
> そしてみなさん、今度こそ完了です。もうこれ以上何もできません。

37:50
Well, I can't believe it, but we are now officially positively undeniably indisputably irreversibly done with 30 days to learn laravel.
> さて、信じられないことですが、この「30日間でLaravelを学ぶ」コースが、正式に、間違いなく、議論の余地なく、紛れもなく、否応なしに終了しました。

38:00
It has been a massive effort for both you and me.
> みなさにとっても私にとっても大変な努力でした。

38:04
So if you have made it through all of these 30 days, trust me, I've watched a lot of courses myself and rarely do I complete them.
> あなたがこの30日間をすべてやりとげたのなら、信じてください、私自身たくさんのコースをやったことがありますが、最後までやり通したことはまれです。

38:11
So whether you intended it or not, I'm going to take that as a compliment.
> ですから、あなたがこれをどう思っているかは分かりませんが、私はそれを褒め言葉として受け取ります。

38:16
All right, so let's talk about this. Come here.
> では、この話をしましょう。こっちに来てください。

38:19
I have recorded iterations of this course for about 10 years now.
> 私はもう10年ほど、このコースを繰り返し撮ってきました。

38:24
It goes all the way back to 2013 with Laravel three from scratch, if you can believe it.
> それは2013年の「Laravel 3 from scratch」から始まりました。信じられますか。

38:29
And yeah, it never fails. Every single time people will complain that we didn't cover such and such topic.
> そして、いつもこうです。毎回毎回、あの話題やこの話題を取り上げなかったとみんな文句を言います。

38:36
You know, there's, there's nothing here about package development. What about APIs? What about events? You didn't talk about livewire or inertia. How come?
> ここではパッケージ開発は取り上げてません。APIは？イベントは？LivewireやInertiaについて触れてないのはなぜ？

38:45
And I'm going to tell you the answer to that question right now.
> 今、その疑問に答えましょう。

38:47
The reason is because we didn't.
> なぜなら、そうしなかったからです。

38:51
Well, okay.
> 「あ、そう、分かった。」

38:54
You know, as the saying goes, your learning doesn't conclude the moment you finish a beginner related course. I'm sorry to say, it has only just begun.
> よく言われるように、初心者用のコースを終えたからといってあなたの学習が終わるわけではありません。こんなことを言って申し訳ありませんが、まだ始まったばかりです。

39:04
So yes, I would encourage you to learn more about Livewire and we have a course for that on Laracasts.
> そうですね、次はLivewireについて学ぶことをお勧めします。Laracastでそのためのコースをご用意しています。

39:09
Yes, you should learn more about API development and we have a course for that.
> API開発についても学ぶべきです。そのためのコースもあります。

39:13
Yes, you should learn more about inertia js and we have a course for that.
> Inertia.jsも学んだほうがいいですね。そのためのコースもあります。

39:17
But do they belong in a beginner specific course?
> でもそれらは初心者用のコースといえるでしょうか？

39:21
Well, that's up to you to decide, but I choose no.
> それを決めるのはあなた次第ですが、私は違うと思います。

39:25
There is such a thing as giving people too much all at once.
> 世の中には、一度にたくさんのことを詰め込みすぎているようなコースがあります。

39:29
And I would rather you complete the course and then move on, versus become overwhelmed by the material in one course.
> １つのコースでその内容に圧倒されてしまうよりは、１つずつコースを完了させてから次へ進むことをお勧めします。

39:37
Okay, so this is somewhat of a bittersweet momemt for me because I know most of you are watching this as a free course, maybe even on YouTube. And you're never going to sign up for laracasts.
> ところで、今は私にとってうれしくもあり悲しくもある時間です。というのも、ほとんどのみなさんはこれを無料のコースとして、もしくはYouTubeでご覧になっていて、Laracastにアカウントを登録することはないだろうと分かっているからです。

39:49
Even though, did you know that you can sign up for laracasts for $15 a month, 15 bucks?
> たとえそうだとしても、みなさんご存じですか？Laracastsは月額15ドル、15ドルで登録できるんです。

39:55
I went to Subway yesterday and it wat 15 bucks.
> 私は昨日、サブウェイに行って15ドルかかりました。

39:57
You could access everything we have ever created for 15 bucks a month.
> 月額15ドルで、私たちがこれまで作成したものすべてにアクセスできるようになります。

40:02
But I already know monst of you won't.
> でも、ほとんどの人はしないことは分かっています。

40:06
Some of you will, and I immensely appreciate it, but most of you won't.
> 登録してくれる人もいるでしょう。それは本当に感謝します。でもほとんどの人はそうしません。

40:11
You'll finish this video. You're probably already done. You're probably not even listening to me at this point. You've already moved on to something else.
> もうすぐ動画が終わります。もしかするともう見るのをやめてしまっているかも、別のことを始めていて、この時点まで聞いてくれていないかもしれません。

40:16
And we'll never see each other again, and that is a bittersweet moment.
> そしてお互いもう出会うことはないでしょう。これがうれしくもあり悲しくもある時間ということです。

40:20
So, I'm going to finish up with a song to show you how I feel when you don't sign up for laracasts.
> それでは最後に、皆さんがLaracastに登録しなかったときの私の気持ちを曲で表したいと思います。

40:26
Let me show you.
> 聞いてください。

40:37
(「Squares Suspended」By Andrew York)
> (「Squares Suspended」アンドリュー・ヨーク)

43:11
Oh my God, they're here.
> 大変だ、彼らが来た。

43:13
Wish me luck.
> 幸運を祈ってくれ。
